<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather</title>
    <script
      src="https://kit.fontawesome.com/5234894da6.js"
      crossorigin="anonymous"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />

    <link href="Weather.css" />
  </head>
  <body>
    <div class="container">
      <form class="form">
        <input type="text" placeholder="Search city name..." class="text" />
        <button class="search">Search</button>
        <button class="current">Current</button>
      </form>
      <div class="row">
        <div class="col-4 WeekDays">
          <div class="row Fri">
            <div class="col-2">Fri</div>
            <div class="col-2">
              <i class="fa-solid fa-cloud-rain"></i>
            </div>
            <div class="col-2">18º</div>
          </div>
          <div class="row Sat">
            <div class="col-2">Sat</div>
            <div class="col-2">
              <i class="fa-solid fa-sun"></i>
            </div>
            <div class="col-2">20º</div>
          </div>
          <div class="row Sun">
            <div class="col-2">Sun</div>
            <div class="col-2">
              <i class="fa-solid fa-cloud"></i>
            </div>
            <div class="col-2">19º</div>
          </div>
          <div class="row Mon">
            <div class="col-2">Mon</div>
            <div class="col-2">
              <i class="fa-solid fa-cloud-rain"></i>
            </div>
            <div class="col-2">21º</div>
          </div>
          <div class="row Tue">
            <div class="col-2">Tue</div>
            <div class="col-2">
              <i class="fa-solid fa-sun"></i>
            </div>
            <div class="col-2">20º</div>
          </div>
        </div>
        <div class="col-4 city">
          <h1>Tehran</h1>
          <h4>Thursday 14:10</h4>
          <span class="h2">19</span>
          <span><a class="centi">°C</a></span>
          <h3>Clouds</h3>
          <div class="precip">Precipitation: 20%</div>
          <div class="wind">Wind: 9km/h</div>
        </div>
      </div>
    </div>
    <script>
      let currentTime = new Date();

      let hours = currentTime.getHours();
      let minutes = currentTime.getMinutes();
      let days = [
        "Sunday",
        "Monday",
        "Tuesday",
        "Wednesday",
        "Thursday",
        "Friday",
        "Saturday",
      ];
      let day = days[currentTime.getDay()];
      let header4 = document.querySelector("h4");
      header4.innerHTML = `${day} ${hours}:${minutes}`;

      function showTemp(response) {
        let temperature = Math.round(response.data.main.temp);
        let header2 = document.querySelector(".h2");
        header2.innerHTML = temperature;
      }

      function showCity(event) {
        event.preventDefault();
        let citySearch = document.querySelector(".text");
        let header1 = document.querySelector("h1");
        header1.innerHTML = `${citySearch.value}`;
        let apiKey = "2513f3c728b1b5ff4f4347e1a6af22b8";
        let apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${citySearch.value}&appid=${apiKey}`;
        axios.get(apiUrl).then(showTemp);
      }
      let search = document.querySelector(".form");
      search.addEventListener("submit", showCity);

      function positioning(position) {
        let latitude = position.coords.latitude;
        let longitude = position.coords.longitude;
        let apiKey2 = "2513f3c728b1b5ff4f4347e1a6af22b8";
        let apiUrl2 = `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${apiKey2}`;
        axios.get(apiUrl2).then(display);
      }
      navigator.geolocation.getCurrentPosition(positioning);

      function display(response) {
        let headerName = document.querySelector("h1");
        headerName.innerHTML = response.data.name;
        let temper = Math.round(response.data.main.temp);
        let headerTemp = document.querySelector(".h2");
        headerTemp.innerHTML = temper;
        console.log(response);
      }

      let current = document.querySelector(".current");
      current.addEventListener("click", display);
    </script>
  </body>
</html>
